{% extends 'blog/layout.html' %}
{% load static %}

{% block body %}
<div class="profile-container">
    <div class="profile-header">
        <div class="avatar-container">
            {# Use profile_obj.profile_picture to access the picture of the profile being displayed #}
            {% if profile_obj.profile_picture %}
                <img src="{{ profile_obj.profile_picture.url }}" alt="{{ profile_obj.user.username }}'s Avatar" class="profile-avatar">
            {% else %}
                <img src="{% static 'blog/images/default-avatar.png' %}" alt="Default Avatar" class="profile-avatar">
            {% endif %}
        </div>
        <div class="profile-info">
            <h1>{{ profile_obj.user.username }}</h1>
            {% if profile_obj.user == request.user %}
                <a href="{% url 'accounts:edit_profile' %}" class="edit-profile-btn">edit profile</a>
            {% endif %}
        </div>
    </div>

    <div class="profile-content">
        <div class="profile-section">
            <h2>Popular posts</h2>
            <div class="post-list">
                {% for post in posts %}
                    <a href="{{ post.get_absolute_url }}" class="post-link">
                        <div class="post-card">
                            <div class="post-header">
                                <h3 class="profile-section-post-title">{{ post.title|safe }}</h3>
                                <span class="post-status {% if post.status == 'published' %}published{% else %}draft{% endif %}">
                                    {{ post.status|title }}
                                </span>
                            </div>
                            <p class="post-description">{{ post.content|striptags|truncatewords:15|safe }}</p>
                            <div class="profile-post-meta">
                                <span class="profile-post-date">{{ post.pub_date|date:"F d, Y" }}</span>
                            </div>
                        </div>
                    </a>
                {% empty %}
                    <p>No posts available.</p>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
